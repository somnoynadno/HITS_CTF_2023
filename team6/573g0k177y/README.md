# 573g0k177y (Hard) [Стеганография, SQL]

## Авторы
Галяткин Дмитрий, Грицаев Никита, Данил Зубов, Баян Шонходоев

## Описание
На единственной странице (index.php) есть две png-картинки с котиками. При нажатии на котика в таблице показываются данные о нем. Цель - раздобыть скрытую информацию. Котиков в базе на самом деле больше двух, и запись об одном из них содержит флаг. 

Но как после нажатия на картинку происходит обработка запроса? Алгоритм считывает по 8 пикселей изображения (png, 128x128px), получая значение синего цвета (0-255), определяет последний бит (0 или 1). Итого, каждый раз он считывает 8 бит (что-то вроде 01010011) и переводит эту последовательность в ASCII-символ (01010011 = 83, что соответствует символу S). Считывание происходит до тех пор, пока алгоритм не натыкается на символ ";"

## Легенда
Вася - студент-второкурсник. Он очень любит кошек. В этом учебном году на курсе баз данных он увлекся SQL. Помимо этого, его очень заинтересовала стеганография, о которой он узнал с курса основ компьютерной безопасности.

Вася решил попрактиковаться в стеганографии и сделал веб-сервис. На основной (и единственной) странице есть две картинки с котиками. При нажатии на котика показываются данные о нем. Цель - раздобыть скрытую информацию (котиков в базе на самом деле больше двух, и один из них охраняет флаг).  

## Подсказки к решению
- Ищите запрос к базе данных в синем канале. Алгоритм считывает по 8 пикселей изображения, получая значение синего цвета (0-255), определяет последний бит (0 или 1). Итого, каждый раз он считывает 8 бит (что-то вроде 01010011) и переводит эту последовательность в ASCII-символ. Считывание происходит до тех пор, пока алгоритм не натыкается на символ ";"

## Инструкция по развертыванию
Простой php-сервис с БД (MySQL). Весь код, Dockerfile, docker-compose.yml, .dockerignore находятся в папке app. В папке app/db есть скрипт, который инициализирует БД (это должно произойти автоматически).

Содержимое папки solution не должно быть доступно студенту, мы добавили это для преподавателей

### ЕСЛИ ПРИ НАЖАТИИ НА КАРТИНКУ НИЧЕГО НЕ ПРОИСХОДИТ, ЗНАЧИТ, СКОРЕЕ ВСЕГО БД НЕ УСПЕЛА ИНИЦИАЛИЗИРОВАТЬСЯ, ПОДОЖДИТЕ ПОДОЛЬШЕ (НЕСКОЛЬКО МИНУТ)

## Флаг
HITS{V45y4_L0v35_8lu3_c0L0UR}
Находится в скрипте (в самом конце), который инициализирует базу данных (app/db/script.sql).

В папке solution находится Python-скрипт (stego.py), который мы использовали для создания картинок со спрятанными в них запросами, а также два файла - input.png (оригинальное изображение) и output.png (в эту картинку вшит запрос, получающий всю таблицу пользователей).

Запускать скрипт необязательно, поскольку для его запуска необходимо установить доп. модули, можно сразу воспользоваться картинкой output.png

## Инструкция по прорешиванию и получению флага
- Выбрать одно из двух изображений для исследования. Взять последние биты синего цвета (соответствующая подсказка дана в HTML-комментарии), сгруппировать по 8 бит и перевести в ASCII (преподаватель может не воспроизводить этот шаг для получения флага)
- Увидеть SQL-запрос (преподаватель может не воспроизводить этот шаг для получения флага)
- Сделать свою картинку, в которую вшит текст SELECT * FROM users; (преподаватель может воспользоваться картинкой output.png в папке solution)
- Подменить адрес картинки в onclick (в HTML-коде страницы) на адрес своей (например, можно использовать онлайн-сервис https://imgur.com/, т. е. выгрузить туда картинку, скопировать ее URL (именно ее URL, а не "страницы поста" !!! это должна быть ссылка вида https://i.imgur.com/2zr6Nkr.png))
- Нажать на картинку
- Увидеть флаг в получившейся таблице (колонка secret_code)

